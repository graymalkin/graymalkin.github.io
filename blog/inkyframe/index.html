<!DOCTYPE html>
<html lang="en">
  <title>Inky Frame &mdash; Simon Cooksey Blog</title>
  <meta name="viewport" content="width=device-width, user-scalable=yes">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="preload" href="/fonts.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/fonts.css"></noscript>
  <link rel="stylesheet" type="text/css" href="/style.css"/>
  <meta name="description" content="Simon's Blog, with personal projects and some academic musings.">
  <meta charset="utf-8">
</head>
<body>
  <main>
    <h1 class="title"><span class="headline-word">Inky</span> <span
class="headline-word">Frame</span></h1>
    <div class="byline"><span class="headline-word">Colour</span> <span
class="headline-word">e-paper</span> <span
class="headline-word">weather</span> <span
class="headline-word">display</span></div>
    <div class="date">2025-02-14</div>
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/blog/">Blog</a></li>
            <li><a href="/iso-papers">ISO Papers</a></li>
            <li><a href="/photography/">Photography</a></li>
        </ul>
    </nav>
<p>Pimoroni in the UK sell a cute <a
href="https://shop.pimoroni.com/products/inky-frame-5-7?variant=40048398958675">5.7”
e-paper photo frame</a>, with an integrated Raspberry Pi Pico W. They’re
pretty pricey, but colour e-paper is very cool. I’ve had it for a while,
and had grand visions of building a customisable YAML driven home
assistant front-end for it, to display stats about the house, weather,
inside and outside temperatures, and other nerdery. Like all the best
laid plans though, it never really got anywhere. Time and other
priorities meant it was left languishing in a drawer and I never got the
project past a barely functional prototype.</p>
<p>Well last weekend, while procrastinating building a <a
href="/blog/allotment/winter-24/#february">greenhouse base</a> (it was
raining…), I remembered it and thought I could do something more simple.
The Met Office publishes a few APIs, one of which provides images for
map overlays.</p>
<p>I hacked together a couple of scripts, one which runs locally on my
network pulls a day’s worth of imagery from the Met Office API and
processes it to be easy to display on the Inky Frame. Those images are
then hosted on the same pi’s web server, where the Raspberry Pi Pico W
can grab them conveniently over Wi-Fi. It’s probably not so hard to do
this all in-device on the Pico W itself, but I wanted to experiment with
different dithering, resizing, and cropping – all of which are much
faster to do on a computer than a Pico. <img
src="/blog/inkyframe/images/eink-weather.jpg"
alt="Completed project" /></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>API_URL <span class="op">=</span> <span class="st">&quot;https://data.hub.api.metoffice.gov.uk/map-images/1.0.0&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>MET_OFFICE_API_KEY <span class="op">=</span> <span class="st">&quot;&quot;&quot;YOUR KEY HERE&quot;&quot;&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>ORDER_NAME <span class="op">=</span> <span class="st">&quot;YOUR ORDER NUMBER HERE&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>FILENAME_BASE <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of files in the job, filter out dupes.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>req <span class="op">=</span> urllib.request.Request(API_URL <span class="op">+</span> <span class="st">&quot;/orders/&quot;</span> <span class="op">+</span> ORDER_NAME <span class="op">+</span> <span class="st">&quot;/latest&quot;</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>req.add_header(<span class="st">&quot;apikey&quot;</span>, MET_OFFICE_API_KEY)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>req.add_header(<span class="st">&quot;Accept&quot;</span>, <span class="st">&quot;application/json&quot;</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>resp <span class="op">=</span> urllib.request.urlopen(req).read()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> json.loads(resp.decode(<span class="st">&quot;utf-8&quot;</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> []</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> data[<span class="st">&quot;orderDetails&quot;</span>][<span class="st">&quot;files&quot;</span>]:</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    fileId <span class="op">=</span> <span class="bu">file</span>[<span class="st">&quot;fileId&quot;</span>]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&quot;_+00&quot;</span> <span class="kw">not</span> <span class="kw">in</span> fileId <span class="kw">and</span> <span class="st">&quot;ts&quot;</span> <span class="kw">in</span> fileId:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        timestamp <span class="op">=</span> datetime.datetime.strptime(<span class="bu">file</span>[<span class="st">&quot;runDateTime&quot;</span>], <span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S%z&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        timestep <span class="op">=</span> <span class="bu">int</span>(re.findall(<span class="vs">r&quot;ts\d\d?&quot;</span>, fileId)[<span class="dv">0</span>][<span class="dv">2</span>:])</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> re.split(<span class="vs">r&quot;_&quot;</span>, fileId)[<span class="dv">0</span>]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        timestamp <span class="op">=</span> timestamp <span class="op">+</span> datetime.timedelta(hours<span class="op">=</span>timestep)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        files.append({<span class="st">&#39;fileId&#39;</span> : fileId, <span class="st">&#39;timestamp&#39;</span>: timestamp, <span class="st">&#39;series&#39;</span>: series})</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Download each file from the list of files.</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    req <span class="op">=</span> urllib.request.Request(API_URL <span class="op">+</span> <span class="st">&quot;/orders/&quot;</span> <span class="op">+</span> ORDER_NAME <span class="op">+</span> <span class="st">&quot;/latest/&quot;</span> <span class="op">+</span> <span class="bu">file</span>[<span class="st">&#39;fileId&#39;</span>] <span class="op">+</span> <span class="st">&quot;/data&quot;</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    req.add_header(<span class="st">&quot;apikey&quot;</span>, MET_OFFICE_API_KEY)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    req.add_header(<span class="st">&quot;Accept&quot;</span>, <span class="st">&quot;image/png&quot;</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    resp <span class="op">=</span> urllib.request.urlopen(req).read()</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> FILENAME_BASE <span class="op">+</span> <span class="st">&quot;</span><span class="sc">{}</span><span class="st">-</span><span class="sc">{}</span><span class="st">.png&quot;</span>.<span class="bu">format</span>(<span class="bu">file</span>[<span class="st">&#39;series&#39;</span>], <span class="bu">file</span>[<span class="st">&#39;timestamp&#39;</span>].strftime(<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">-%H&quot;</span>))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        f.write(resp)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(filename)</span></code></pre></div>
<p>This produces a bunch of PNG files with names like
<code>temperature-2025-02-14-10.png</code> (the temperature forecast for
Valentine’s Day 2025 at 10:00). The Micro Python libraries available for
the Inky Frame only support JPEG compression, so I have written a bash
script which calls imagemagick to convert all the output PNGs into
JPEGs. The PNGs returned by the Met Office do not include a map
background layer (despite what their sample data shows…) so I composite
in a background image for the British Isles. I experimented with using
imagemagick’s dithering, but the automatic dithering done by the JPEG
library on the Inky Frame produced (to me) a more pleasing result. This
script also copies the files to the web server’s hosted directory.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /home/simon/weather</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete old files</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> temperature-<span class="pp">*</span>.png</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> mean-<span class="pp">*</span>.png</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> total-<span class="pp">*</span>.png</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> <span class="pp">*</span>.jpeg</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="kw">`</span><span class="ex">python3</span> /home/simon/weather/metoffice.py<span class="kw">`;</span> <span class="cf">do</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">convert</span> <span class="at">-composite</span> <span class="at">-compose</span> Multiply british-isles.png <span class="va">$f</span> <span class="at">-crop</span> 600x448+200+352 <span class="va">${f</span><span class="op">%</span>.<span class="pp">*</span><span class="va">}</span>.jpeg<span class="kw">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> /var/www/html/weather/<span class="pp">*</span>.jpeg</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> <span class="pp">*</span>.jpeg /var/www/html/weather/</span></code></pre></div>
<p>Then, on the Inky Frame itself I hacked together some Micro Python to
download the correct file based on the setting of the RTC, and update
the display accordingly.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> machine</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gc</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ntptime</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jpegdec</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sdcard</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> uos</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib <span class="im">import</span> urequest</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> picographics <span class="im">import</span> PicoGraphics, DISPLAY_INKY_FRAME <span class="im">as</span> DISPLAY</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> inky_helper <span class="im">as</span> ih</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>IF_MISO <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>IF_CLK <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>IF_MOSI <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>IF_SD_CS <span class="op">=</span> <span class="dv">22</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>BASE_URL <span class="op">=</span> <span class="st">&quot;http://raspberrypi/weather/&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>FILENAME <span class="op">=</span> <span class="st">&quot;/sd/current-weather.jpeg&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>UPDATE_INTERVAL<span class="op">=</span><span class="dv">60</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>time_string <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>MODES <span class="op">=</span> [ {<span class="st">&quot;url&quot;</span>: <span class="st">&quot;temperature&quot;</span>, <span class="st">&#39;string&#39;</span>: <span class="st">&quot;Temperature&quot;</span> }, {<span class="st">&quot;url&quot;</span>: <span class="st">&quot;mean&quot;</span>, <span class="st">&#39;string&#39;</span>: <span class="st">&quot;Pressure&quot;</span> }, {<span class="st">&quot;url&quot;</span>: <span class="st">&quot;total&quot;</span>, <span class="st">&#39;string&#39;</span>: <span class="st">&quot;Precipitation&quot;</span> } ]</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>MONTH <span class="op">=</span> [<span class="st">&quot;&quot;</span>, <span class="st">&quot;January&quot;</span>, <span class="st">&quot;February&quot;</span>, <span class="st">&quot;March&quot;</span>, <span class="st">&quot;April&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;July&quot;</span>, <span class="st">&quot;August&quot;</span>, <span class="st">&quot;September&quot;</span>, <span class="st">&quot;November&quot;</span>, <span class="st">&quot;December&quot;</span>]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> { <span class="st">&quot;url&quot;</span> : <span class="va">None</span> }</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>gc.collect()</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>ih.led_warn.on()</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        sd_spi <span class="op">=</span> machine.SPI(<span class="dv">0</span>, sck<span class="op">=</span>machine.Pin(<span class="dv">18</span>, machine.Pin.OUT), mosi<span class="op">=</span>machine.Pin(<span class="dv">19</span>, machine.Pin.OUT), miso<span class="op">=</span>machine.Pin(<span class="dv">16</span>, machine.Pin.OUT))</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        sd <span class="op">=</span> sdcard.SDCard(sd_spi, machine.Pin(<span class="dv">22</span>))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">OSError</span>:</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        sd <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        ih.inky_frame.button_e.led_on()</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        ih.inky_frame.button_e.led_off()</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;failed to connect to SD card, retrying&quot;</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>ih.led_warn.off()</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>uos.mount(sd, <span class="st">&quot;/sd&quot;</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>gc.collect()</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> secrets <span class="im">import</span> WIFI_SSID, WIFI_PASSWORD</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    ih.network_connect(WIFI_SSID, WIFI_PASSWORD)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Create secrets.py with your Wi-Fi credentials&quot;</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    reset()</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Get some memory back, we really need it!</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>gc.collect()</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Wi-Fi Connected&quot;</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>graphics <span class="op">=</span> PicoGraphics(DISPLAY)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>WIDTH, HEIGHT <span class="op">=</span> graphics.get_bounds()</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>graphics.set_font(<span class="st">&quot;bitmap8&quot;</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn any LEDs off that may still be on from last run.</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>ih.clear_button_leds()</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>ih.led_warn.off()</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_to_url(current_t, mode):</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> time_string</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> BASE_URL <span class="op">+</span> <span class="st">&quot;</span><span class="sc">{}</span><span class="st">-</span><span class="sc">{:02d}</span><span class="st">-</span><span class="sc">{:02d}</span><span class="st">-</span><span class="sc">{:02d}</span><span class="st">-</span><span class="sc">{:02d}</span><span class="st">.jpeg&quot;</span>.<span class="bu">format</span>(MODES[mode][<span class="st">&quot;url&quot;</span>], current_t[<span class="dv">0</span>], current_t[<span class="dv">1</span>], current_t[<span class="dv">2</span>], current_t[<span class="dv">3</span>])</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    time_string <span class="op">=</span> <span class="st">&quot;</span><span class="sc">{}</span><span class="st"> </span><span class="sc">{}</span><span class="st"> </span><span class="sc">{}</span><span class="st"> </span><span class="sc">{}</span><span class="st"> </span><span class="sc">{:02d}</span><span class="st">:00&quot;</span>.<span class="bu">format</span>(MODES[mode][<span class="st">&quot;string&quot;</span>], current_t[<span class="dv">2</span>], MONTH[current_t[<span class="dv">1</span>]], current_t[<span class="dv">0</span>], current_t[<span class="dv">3</span>])</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> url</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_time():</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Correct the time while we&#39;re at it</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        ih.inky_frame.set_time()</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(time.localtime())</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> e:</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(e)</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        show_error(<span class="st">&quot;Unable to set time: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(e))</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        ih.led_warn.on()</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(url):</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Update&quot;</span>)</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Grab the image</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>        ih.pulse_network_led()</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        socket <span class="op">=</span> urequest.urlopen(url)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> <span class="bu">bytearray</span>(<span class="dv">1024</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(FILENAME, <span class="st">&quot;wb&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> socket.readinto(data) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>                f.write(data)</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>        socket.close()</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> data</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">OSError</span> <span class="im">as</span> e:</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(e)</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>        show_error(<span class="st">&quot;Unable to download image&quot;</span>)</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>        ih.led_warn.on()</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">finally</span>:</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>        ih.stop_network_led()</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_error(text):</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    graphics.set_pen(<span class="dv">4</span>)</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    graphics.rectangle(<span class="dv">0</span>, <span class="dv">10</span>, WIDTH, <span class="dv">70</span>)</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>    graphics.set_pen(<span class="dv">1</span>)</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>    graphics.text(text, <span class="dv">5</span>, <span class="dv">16</span>, <span class="dv">635</span>, <span class="dv">2</span>)</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw():</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> state</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>        jpeg <span class="op">=</span> jpegdec.JPEG(graphics)</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>        graphics.set_pen(<span class="dv">1</span>)</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>        graphics.clear()</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>        jpeg.open_file(FILENAME)</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>        jpeg.decode()</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>        graphics.set_pen(<span class="dv">0</span>)</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        graphics.rectangle(<span class="dv">0</span>, <span class="dv">0</span>, WIDTH, <span class="dv">25</span>)</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>        graphics.set_pen(<span class="dv">1</span>)</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        graphics.text(time_string, <span class="dv">5</span>, <span class="dv">5</span>, WIDTH, <span class="dv">2</span>)</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">OSError</span> <span class="im">as</span> e:</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>        show_error(<span class="st">&quot;Unable to display image! OSError: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(e))</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        ih.inky_frame.button_b.led_on()</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>        show_error(<span class="st">&quot;Unable to display image! Error: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(e))</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>        ih.inky_frame.button_c.led_on()</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">finally</span>:</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>        graphics.update()</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> save_state(data):</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;/state.json&quot;</span>, <span class="st">&quot;w&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>        f.write(json.dumps(data))</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>        f.flush()</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_state():</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> state</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> json.loads(<span class="bu">open</span>(<span class="st">&quot;/state.json&quot;</span>, <span class="st">&quot;r&quot;</span>).read())</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(data) <span class="kw">is</span> <span class="bu">dict</span>:</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>        state <span class="op">=</span> data</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>        state <span class="op">=</span> { <span class="st">&quot;url&quot;</span> : <span class="va">None</span> }</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>set_time()</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Disable deep sleep while we check for an update</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>    ih.inky_frame.vsys.init(machine.Pin.OUT)</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>    ih.inky_frame.vsys.on()</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>    old_url <span class="op">=</span> state[<span class="st">&#39;url&#39;</span>]</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> time_to_url(time.localtime(), <span class="dv">0</span>)</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> old_url <span class="op">!=</span> url:</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;New URL: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(url))</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>        update(url)</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>        draw()</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>        state[<span class="st">&#39;url&#39;</span>] <span class="op">=</span> url</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>        save_state(state)</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">30</span>)</span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sleep for one minute</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>    ih.inky_frame.sleep_for(<span class="dv">1</span>)</span></code></pre></div>
<h2 id="battery-sleep-and-thonny"><span
class="headline-word">Battery,</span> <span
class="headline-word">sleep,</span> <span
class="headline-word">and</span> <span
class="headline-word">Thonny</span></h2>
<p>I had surprising friction trying to take my <code>main.py</code> from
something that worked under Thonny. The update of the screen appears to
be asynchronous, but that seems to mean that calling deep sleep allows
the Pi Pico to sleep before the screen has updated causing meaning it
never draws the JPEG to the display. Thus far, still not working – I am
probably doing something bone-headed, but I can’t see what. For now, it
works when connected to USB (external power disables the sleep function)
so it can sit on my desk powered by my monitor.</p>
  <footer>
    &copy; 2025, Simon Cooksey. Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a><img src="/blog/icons/cc.svg" ><img src="/blog/icons/by.svg" ><img src="/blog/icons/nc.svg" ><img src="/blog/icons/sa.svg" >
  </footer>
  <link rel="preload" href="/orrery.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/orrery.min.css"></noscript>
  <div class="orrery">
    <div id="sun" class="star">
      <div class="flare"></div>
      <div class="flare"></div>
      <div class="flare"></div>
    </div>
    <div id="mercury_orbit" class="orbit"></div>
    <div id="mercury" class="planet"></div>
    <div id="venus_orbit" class="orbit"></div>
    <div id="venus" class="planet"></div>

    <div id="earth_orbit" class="orbit"></div>
    <div id="earth" class="planet">
      <div id="moon"></div>
    </div>

    <div id="mars_orbit" class="orbit"></div>
    <div id="mars" class="planet">
      <div id="phobos"></div>
      <div id="deimos"></div>
    </div>

    <div id="saturn_orbit" class="orbit"></div>
    <div id="saturn" class="planet">
      <div class="ring"></div>
      <div id="titan"></div>
    </div>

    <div id="jupiter_orbit" class="orbit"></div>
    <div id="jupiter" class="planet">
      <div class="spot"></div>
      <div id="io"></div>
      <div id="europa"></div>
      <div id="ganymede"></div>
      <div id="callisto"></div>
    </div>

    <div id="neptune_orbit" class="orbit"></div>
    <div id="neptune" class="planet">
      <div class="ring"></div>
    </div>

    <div id="uranus_orbit" class="orbit"></div>
    <div id="uranus" class="planet"></div>
  </div>
  </main>
  <style>pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */</style>
  </main>
  <style>pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */</style>
</body>
</html>
